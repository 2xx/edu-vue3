import{E as r,b as g}from"./index-454643d3.js";import{E}from"./users-4d3745c7.js";import{E as w}from"./el-tree-373fc12c.js";import"./el-checkbox-55230050.js";import{b as C,c as M}from"./roles-90df6199.js";import{d as b,K as n,o as v,Y as x,a as c,u as i,w as m,F as I,ad as _}from"./runtime-core.esm-bundler-d5958d54.js";import{_ as R}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-338a00ad.js";import"./index-309dffdd.js";import"./isEqual-a9ed7f07.js";import"./_Uint8Array-d1f10f11.js";import"./flatten-5a56c86a.js";const T=b({__name:"AllocMenus",props:{roleId:{type:String,required:!0}},setup(f){const s=f,h=g();console.log(s.roleId);const l=n([]),d=n([]),u=e=>{e.forEach(o=>{o.subMenuList?u(o.subMenuList):o.selected&&d.value.push(o.id)})};(async()=>{const{data:e}=await C(s.roleId);if(e.code==="000000")l.value=e.data,u(e.data);else throw r.error("获取角色菜单权限信息失败..."),new Error("获取角色菜单权限信息失败..."+e.mesg)})();const a=n(null),k=async()=>{var t;const e=(t=a.value)==null?void 0:t.getCheckedKeys(),{data:o}=await M(s.roleId,e);if(o.code==="000000"&&o.data)r.success("更新角色菜单权限成功!"),h.push({name:"roles"});else throw r.error("更新角色菜单权限失败..."),new Error("更新角色菜单权限失败..."+o.mesg)},y=()=>{var e;(e=a.value)==null||e.setCheckedKeys([])};return(e,o)=>{const t=w,p=E;return v(),x(I,null,[c(t,{ref_key:"menuTree",ref:a,data:i(l),props:{label:"name",children:"subMenuList"},"show-checkbox":"","default-expand-all":"","node-key":"id","default-checked-keys":i(d)},null,8,["data","default-checked-keys"]),c(p,{type:"primary",onClick:k},{default:m(()=>[_("保存")]),_:1}),c(p,{type:"",onClick:y},{default:m(()=>[_("清空")]),_:1})],64)}}});const G=R(T,[["__scopeId","data-v-9775f140"]]);export{G as default};
