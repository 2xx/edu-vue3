import{E as y}from"./index-005e4e09.js";import{E as j}from"./el-card-1c929d99.js";import{E as A}from"./el-pagination-79ebdaba.js";import{E as I}from"./el-input-98fd8882.js";/* empty css               */import"./el-select-6965f7d6.js";import"./el-popper-2a158565.js";import{E as F,a as N}from"./el-table-column-0805a62d.js";import"./el-checkbox-ded5f133.js";import"./el-tooltip-4ed993c7.js";import{E as R,a as z}from"./el-form-item-b063b6c6.js";import{E as B}from"./users-1a9b2b7f.js";import{g as q,s as P,a as M,d as h}from"./roles-6ceb8b79.js";import{E as K}from"./el-dialog-f97f546f.js";import"./el-overlay-63796e00.js";import{d as O,K as b,N as U,o as T,c as D,w as a,Z as L,a as e,ad as p,u as o,O as W}from"./runtime-core.esm-bundler-d5958d54.js";import{t as Z}from"./timeHandlers-ece731f7.js";import{E as G}from"./el-message-box-fbccc3cf.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-2118f34c.js";import"./isEqual-84f5bf45.js";import"./_Uint8Array-0b7ce9b1.js";import"./scroll-37d47f00.js";import"./index-fe7efd55.js";import"./_initCloneObject-7bde75f9.js";import"./flatten-96b7b984.js";import"./refs-e5ab6f88.js";import"./dayjs.min-ea7bbe63.js";const J={class:"dialog-footer"},Q=O({__name:"DlgRoleCreateOrEdit",emits:["role-change"],setup(w,{expose:c,emit:k}){const s=b(!1),t="100px",i=()=>({code:"",name:"",description:""}),r=U(i()),E=b(!0),f=b("");c({initAndShow:async(d=0)=>{if(s.value=!0,Object.assign(r,i()),d){E.value=!1,f.value="更新";const{data:n}=await q(d);if(n.code==="000000")console.log(n),Object.assign(r,n.data);else throw y.error(`获取ID为${d}的角色信息失败`+n.mesg),new Error(`获取ID为${d}的角色信息失败`+n.mesg)}else E.value=!0,f.value="创建"}});const V=async()=>{const{data:d}=await P(r).finally(()=>s.value=!1);if(d.code==="000000")y.success(`${f.value}角色成功!`),k("role-change");else throw y.error(`${f.value}角色失败...`),new Error(`${f.value}角色失败...`)};return(d,n)=>{const l=I,m=R,C=z,$=B,S=K;return T(),D(S,{modelValue:o(s),"onUpdate:modelValue":n[4]||(n[4]=_=>W(s)?s.value=_:null),title:o(f)+"角色"},{footer:a(()=>[L("span",J,[e($,{onClick:n[3]||(n[3]=_=>s.value=!1)},{default:a(()=>[p("取消")]),_:1}),e($,{type:"primary",onClick:V},{default:a(()=>[p(" 确认 ")]),_:1})])]),default:a(()=>[e(C,{model:o(r)},{default:a(()=>[e(m,{label:"角色名称","label-width":t,prop:"name"},{default:a(()=>[e(l,{modelValue:o(r).name,"onUpdate:modelValue":n[0]||(n[0]=_=>o(r).name=_),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"角色编码","label-width":t,prop:"code"},{default:a(()=>[e(l,{modelValue:o(r).code,"onUpdate:modelValue":n[1]||(n[1]=_=>o(r).code=_),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"描述","label-width":t,prop:"code"},{default:a(()=>[e(l,{modelValue:o(r).description,"onUpdate:modelValue":n[2]||(n[2]=_=>o(r).description=_),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),u=U({name:"",size:5}),x=b({records:[],size:0,total:0}),g=async(w={})=>{Object.assign(u,w);const{data:c}=await M(u);if(c.code==="000000")x.value=c.data;else throw y.error("按条件查询角色信息失败..."),new Error("按条件查询角色信息失败...")},X=O({__name:"RolesIndex",setup(w){g();const c=b(null),k=async s=>{await G.confirm("确认要删除吗?","删除询问",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).catch(()=>(y.success("删除角色动作被取消.."),new Promise(()=>{})));const{data:t}=await h(s);if(t.code==="000000")y.success("删除角色成功!"),g({current:1});else throw y.error("删除角色失败.."+t.mesg),new Error("删除角色失败.."+t.mesg)};return(s,t)=>{const i=B,r=I,E=R,f=z,v=F,V=N,d=A,n=j;return T(),D(n,{class:"box-card"},{header:a(()=>[e(i,{onClick:t[0]||(t[0]=l=>{var m;return(m=o(c))==null?void 0:m.initAndShow()})},{default:a(()=>[p("新建角色")]),_:1}),e(f,{inline:!0,model:o(u),class:"demo-form-inline"},{default:a(()=>[e(E,{label:"输入搜索"},{default:a(()=>[e(r,{modelValue:o(u).name,"onUpdate:modelValue":t[1]||(t[1]=l=>o(u).name=l),placeholder:"角色名称"},null,8,["modelValue"])]),_:1}),e(E,null,{default:a(()=>[e(i,{type:"",onClick:t[2]||(t[2]=l=>o(g)({name:""}))},{default:a(()=>[p("重置")]),_:1}),e(i,{type:"primary",onClick:t[3]||(t[3]=l=>o(g)({current:1}))},{default:a(()=>[p("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),default:a(()=>[e(V,{data:o(x).records,border:"",style:{width:"100%"}},{default:a(()=>[e(v,{type:"index",label:"序号",align:"center"}),e(v,{prop:"name",label:"角色名称",align:"center"}),e(v,{prop:"description",label:"描述",align:"center"}),e(v,{prop:"createdTime",label:"添加时间",formatter:o(Z),align:"center"},null,8,["formatter"]),e(v,{label:"操作",align:"center",width:"150"},{default:a(({row:l})=>[e(i,{type:"primary",link:"",onClick:m=>s.$router.push({name:"alloc-menus",params:{roleId:l.id}})},{default:a(()=>[p("分配菜单")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>s.$router.push({name:"alloc-resources",params:{roleId:l.id}})},{default:a(()=>[p("分配资源")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>{var C;return(C=o(c))==null?void 0:C.initAndShow(l.id)}},{default:a(()=>[p("编辑")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>k(l.id)},{default:a(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(d,{"current-page":o(u).current,"onUpdate:current-page":t[4]||(t[4]=l=>o(u).current=l),"page-size":o(u).size,"onUpdate:page-size":t[5]||(t[5]=l=>o(u).size=l),"page-sizes":[5,10,20,30],layout:"total, sizes, prev, pager, next, jumper",total:o(x).total,onSizeChange:t[6]||(t[6]=l=>{o(g)({size:l,current:1})}),onCurrentChange:t[7]||(t[7]=l=>{o(g)({current:l})})},null,8,["current-page","page-size","total"]),e(Q,{ref_key:"dlgCreateOrEdit",ref:c,onRoleChange:t[8]||(t[8]=l=>o(g)({current:1}))},null,512)]),_:1})}}});const Ie=H(X,[["__scopeId","data-v-a5ac72f6"]]);export{Ie as default};
