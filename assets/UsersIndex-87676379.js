import{E as b}from"./index-005e4e09.js";import{E as F}from"./el-card-1c929d99.js";import{E as N}from"./el-pagination-79ebdaba.js";import{E as T}from"./el-input-98fd8882.js";/* empty css               */import{E as O,a as j}from"./el-select-6965f7d6.js";import"./el-popper-2a158565.js";import{E as q,a as M}from"./el-table-column-0805a62d.js";import"./el-checkbox-ded5f133.js";import"./el-tooltip-4ed993c7.js";import{E as W}from"./el-switch-d7773092.js";import{E as K}from"./el-avatar-2492ce40.js";import{E as z,a as B}from"./el-form-item-b063b6c6.js";import{h as Y,i as Z,E as R,j as G,k as H,m as J}from"./users-1a9b2b7f.js";import{E as Q}from"./el-date-picker-92f97191.js";import{E as X}from"./el-dialog-f97f546f.js";import"./el-overlay-63796e00.js";import{d as $,K as v,N as ee,o as C,c as A,w as l,Z as S,a as e,ad as V,u as o,Y as te,ar as oe,F as le,O as P,M as ae}from"./runtime-core.esm-bundler-d5958d54.js";import{t as ne}from"./timeHandlers-ece731f7.js";import{_ as re}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-2118f34c.js";import"./isEqual-84f5bf45.js";import"./_Uint8Array-0b7ce9b1.js";import"./scroll-37d47f00.js";import"./index-fe7efd55.js";import"./_initCloneObject-7bde75f9.js";import"./flatten-96b7b984.js";import"./dayjs.min-ea7bbe63.js";import"./index-9231dd87.js";import"./refs-e5ab6f88.js";const se={class:"dialog-footer"},ie=$({__name:"DlgAllocRoles",setup(U,{expose:d}){const u=v(!1),E="140px",i=ee({userId:void 0,roleIdList:[]}),s=v([]);d({initAndShow:async n=>{u.value=!0,console.log(n);const{data:r}=await Y(n);if(r.code==="000000")s.value=r.data,console.log(r.data),i.userId=n,i.roleIdList=r.data.filter(f=>f.hasPermission).map(f=>f.id);else throw b.error("获取用户的角色信息失败..."),new Error("获取用户的角色信息失败...")}});const _=async()=>{const{data:n}=await Z(i.userId,i.roleIdList).finally(()=>{u.value=!1});if(n.code==="000000"&&n.data)b.success("给用户分配角色成功!");else throw b.error("给用户分配角色失败..."),new Error("给用户分配角色失败...")};return(n,r)=>{const f=O,I=j,c=z,x=B,w=R,k=X;return C(),A(k,{modelValue:o(u),"onUpdate:modelValue":r[2]||(r[2]=m=>P(u)?u.value=m:null),title:"分配角色"},{footer:l(()=>[S("span",se,[e(w,{onClick:r[1]||(r[1]=m=>u.value=!1)},{default:l(()=>[V("取消")]),_:1}),e(w,{type:"primary",onClick:_},{default:l(()=>[V(" 确认 ")]),_:1})])]),default:l(()=>[e(x,{model:o(i)},{default:l(()=>[e(c,{label:"","label-width":E},{default:l(()=>[e(I,{modelValue:o(i).roleIdList,"onUpdate:modelValue":r[0]||(r[0]=m=>o(i).roleIdList=m),multiple:"",placeholder:"请选择角色"},{default:l(()=>[(C(!0),te(le,null,oe(o(s),m=>(C(),A(f,{key:m.id,label:m.name,value:m.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}}),p=v({}),g=v({}),h=async(U={})=>{Object.assign(p.value,U);const{data:d}=await G(p.value);if(d.code==="000000")g.value=d.data,console.log(d.data);else throw b.error("获取用户列表失败"+d.mesg),new Error("获取用户列表失败"+d.mesg)},me={class:"card-header"},de=$({__name:"UsersIndex",setup(U){h();const d="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",u=async(s,a)=>{let _={ENABLE:{msg:"启用",fn:H},DISABLE:{msg:"禁用",fn:J}};const{data:n}=await _[s].fn(a);if(n.code==="000000")b.success(`${_[s].msg}用户成功!`);else throw b.error(`${_[s].msg}用户失败~`),new Error(`${_[s].msg}用户失败~`)},E=v("");ae(E,s=>{Array.isArray(s)?(p.value.startCreateTime=s[0].toISOString(),p.value.endCreateTime=s[1].toISOString()):(p.value.startCreateTime="",p.value.endCreateTime="")});const i=v(null);return(s,a)=>{const _=T,n=z,r=Q,f=R,I=B,c=q,x=K,w=W,k=M,m=N,D=F;return C(),A(D,{class:"box-card"},{header:l(()=>[S("div",me,[e(I,{inline:!0,model:o(p),class:"demo-form-inline"},{default:l(()=>[e(n,{label:"手机号"},{default:l(()=>[e(_,{modelValue:o(p).phone,"onUpdate:modelValue":a[0]||(a[0]=t=>o(p).phone=t),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),e(n,{label:"注册时间"},{default:l(()=>[e(r,{modelValue:o(E),"onUpdate:modelValue":a[1]||(a[1]=t=>P(E)?E.value=t:null),type:"datetimerange","start-placeholder":"开始时间","end-placeholder":"结束时间"},null,8,["modelValue"])]),_:1}),e(n,null,{default:l(()=>[e(f,{type:"primary",onClick:a[2]||(a[2]=t=>o(h)({currentPage:1}))},{default:l(()=>[V("查询")]),_:1})]),_:1})]),_:1},8,["model"])])]),default:l(()=>[e(k,{data:o(g).records,border:"",style:{width:"100%"}},{default:l(()=>[e(c,{prop:"id",label:"用户ID",width:"180",align:"center"}),e(c,{label:"头像",width:"180",align:"center"},{default:l(({row:t})=>[e(x,{size:50,src:t.portrait},{default:l(()=>[S("img",{src:d,alt:""})]),_:2},1032,["src"])]),_:1}),e(c,{prop:"name",label:"用户名",width:"180",align:"center"}),e(c,{prop:"phone",label:"手机号",align:"center"}),e(c,{prop:"createTime",label:"注册时间",align:"center",formatter:o(ne)},null,8,["formatter"]),e(c,{label:"状态",align:"center"},{default:l(({row:t})=>[e(w,{modelValue:t.status,"onUpdate:modelValue":y=>t.status=y,class:"mb-2","active-value":"ENABLE","inactive-value":"DISABLE","active-text":"启用","inactive-text":"禁用",onChange:y=>u(y,t.id)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(c,{label:"操作",align:"center"},{default:l(({row:t})=>[e(f,{type:"default",onClick:y=>{var L;return(L=o(i))==null?void 0:L.initAndShow(t.id)}},{default:l(()=>[V("分配角色")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(m,{"current-page":o(g).current,"onUpdate:current-page":a[3]||(a[3]=t=>o(g).current=t),"page-size":o(g).size,"onUpdate:page-size":a[4]||(a[4]=t=>o(g).size=t),"page-sizes":[5,10,20,50],background:!0,layout:"total, sizes, prev, pager, next, jumper",total:o(g).total||0,onSizeChange:a[5]||(a[5]=t=>o(h)({pageSize:t,currentPage:1})),onCurrentChange:a[6]||(a[6]=t=>o(h)({currentPage:t}))},null,8,["current-page","page-size","total"]),e(ie,{ref_key:"dlgAllocRoles",ref:i},null,512)]),_:1})}}});const Oe=re(de,[["__scopeId","data-v-68149094"]]);export{Oe as default};
