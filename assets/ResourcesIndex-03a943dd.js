import{E as b,b as G}from"./index-454643d3.js";import{E as K}from"./el-card-80e98f78.js";import{E as W}from"./el-pagination-912f9994.js";import{E as U}from"./el-input-c28d0f82.js";/* empty css               */import{E as B,a as F}from"./el-select-a246b828.js";import"./el-popper-4f7320ad.js";import{E as Y,a as Z}from"./el-table-column-33d9e1db.js";import"./el-checkbox-55230050.js";import"./el-tooltip-4ed993c7.js";import{E as S,a as D}from"./el-form-item-47cac641.js";import{r as R,E as q}from"./users-4d3745c7.js";import{E as H}from"./el-dialog-533508f3.js";import"./el-overlay-9a593780.js";import{N as P,K as V,d as A,o as w,c as $,w as o,Z as J,a as e,ad as _,u as t,Y as j,ar as N,F as L,O as Q}from"./runtime-core.esm-bundler-d5958d54.js";import{g as h,a as M}from"./useResourceCategory-adf3610d.js";import{t as X}from"./timeHandlers-ece731f7.js";import{E as ee}from"./el-message-box-8bd1bbf3.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-309dffdd.js";import"./isEqual-a9ed7f07.js";import"./_Uint8Array-d1f10f11.js";import"./scroll-3e4250e8.js";import"./index-8a559d97.js";import"./_initCloneObject-c4f14d92.js";import"./flatten-5a56c86a.js";import"./refs-e5ab6f88.js";import"./dayjs.min-ea7bbe63.js";const oe=u=>R({method:"POST",url:"/boss/resource/getResourcePages",data:u}),le=u=>R({method:"POST",url:"/boss/resource/saveOrUpdate",data:u}),re=u=>R({method:"DELETE",url:`/boss/resource/${u}`}),ae=u=>R({method:"GET",url:`/boss/resource/${u}`}),f=P({name:"",url:"",categoryId:"",current:1,size:5}),k=V({current:1,records:[],size:0,total:0}),v=async(u={})=>{Object.assign(f,u);const{data:y}=await oe(f);if(y.code==="000000")k.value=y.data;else throw b.error("获取资源失败.."),new Error("获取资源失败")},ne={class:"dialog-footer"},se=A({__name:"DlgResourceCreateOrEdit",setup(u,{expose:y}){h();const i=V(!1),E=()=>({name:"",categoryId:1,url:"",description:""}),s=P(E()),g="120px",l=V(!0),m=V("");y({initAndShow:async(p=0)=>{if(Object.assign(s,E()),i.value=!0,p){l.value=!1,m.value="更新";const{data:a}=await ae(p);if(a.code==="000000")Object.assign(s,a.data);else throw b.error(`获取ID为${p}的资源信息失败...`),new Error(`获取ID为${p}的资源信息失败...`)}else l.value=!0,m.value="创建"}});const I=async()=>{const{data:p}=await le(s).finally(()=>i.value=!1);if(p.code==="000000")b.success(`${m.value}资源成功!`),v({current:1});else throw b.error(`${m.value}资源失败!`),new Error(`${m.value}资源失败!`)};return(p,a)=>{const x=U,d=S,O=B,T=F,z=D,r=q,c=H;return w(),$(c,{title:t(m)+"资源",modelValue:t(i),"onUpdate:modelValue":a[5]||(a[5]=n=>Q(i)?i.value=n:null)},{footer:o(()=>[J("span",ne,[e(r,{onClick:a[4]||(a[4]=n=>i.value=!1)},{default:o(()=>[_("取 消")]),_:1}),e(r,{type:"primary",onClick:I},{default:o(()=>[_("确 定")]),_:1})])]),default:o(()=>[e(z,{model:t(s)},{default:o(()=>[e(d,{label:"资源名称","label-width":g,prop:"name"},{default:o(()=>[e(x,{modelValue:t(s).name,"onUpdate:modelValue":a[0]||(a[0]=n=>t(s).name=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(d,{label:"资源路径","label-width":g,prop:"url"},{default:o(()=>[e(x,{modelValue:t(s).url,"onUpdate:modelValue":a[1]||(a[1]=n=>t(s).url=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(d,{label:"资源类别","label-width":g,prop:"categoryId"},{default:o(()=>[e(T,{modelValue:t(s).categoryId,"onUpdate:modelValue":a[2]||(a[2]=n=>t(s).categoryId=n),placeholder:"资源类别"},{default:o(()=>[(w(!0),j(L,null,N(t(M),n=>(w(),$(O,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"资源描述","label-width":g,prop:"description"},{default:o(()=>[e(x,{type:"textarea",modelValue:t(s).description,"onUpdate:modelValue":a[3]||(a[3]=n=>t(s).description=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])}}}),ue=A({__name:"ResourcesIndex",setup(u){const y=G();v(),h();const i=V(),E=V(null),s=async g=>{await ee.confirm("确实要删除吗?","删除询问",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).catch(()=>(b.info("删除动作被取消..."),new Promise(()=>{})));const{data:l}=await re(g);if(l.code==="000000")b.success("删除资源成功!"),v({current:1});else throw b.error("删除资源失败..."),new Error("删除资源失败...")};return(g,l)=>{const m=U,C=S,I=B,p=F,a=q,x=D,d=Y,O=Z,T=W,z=K;return w(),$(z,{class:"box-card"},{header:o(()=>[e(x,{inline:!0,model:t(f),ref_key:"queryFm",ref:i,class:"demo-form-inline"},{default:o(()=>[e(C,{label:"资源名称",prop:"name"},{default:o(()=>[e(m,{modelValue:t(f).name,"onUpdate:modelValue":l[0]||(l[0]=r=>t(f).name=r),placeholder:"资源名称"},null,8,["modelValue"])]),_:1}),e(C,{label:"资源路径",prop:"url"},{default:o(()=>[e(m,{modelValue:t(f).url,"onUpdate:modelValue":l[1]||(l[1]=r=>t(f).url=r),placeholder:"资源路径"},null,8,["modelValue"])]),_:1}),e(C,{label:"资源分类",prop:"categoryId"},{default:o(()=>[e(p,{modelValue:t(f).categoryId,"onUpdate:modelValue":l[2]||(l[2]=r=>t(f).categoryId=r),placeholder:"资源分类"},{default:o(()=>[e(I,{label:"不限",value:""}),(w(!0),j(L,null,N(t(M),r=>(w(),$(I,{key:r.id,label:r.name,value:r.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(C,null,{default:o(()=>[e(a,{type:"",onClick:l[3]||(l[3]=r=>{var c;return(c=t(i))==null?void 0:c.resetFields()})},{default:o(()=>[_("重置")]),_:1}),e(a,{type:"primary",onClick:l[4]||(l[4]=r=>t(v)())},{default:o(()=>[_("搜索查询")]),_:1})]),_:1})]),_:1},8,["model"])]),default:o(()=>[e(a,{size:"large",onClick:l[5]||(l[5]=r=>{var c;return(c=t(E))==null?void 0:c.initAndShow()})},{default:o(()=>[_("添加资源")]),_:1}),e(a,{size:"large",onClick:l[6]||(l[6]=r=>t(y).push({name:"resource-category"}))},{default:o(()=>[_("资源类别")]),_:1}),e(O,{data:t(k).records,border:"",style:{width:"100%"}},{default:o(()=>[e(d,{type:"index",label:"序号",align:"center"}),e(d,{prop:"name",label:"资源名称",align:"center"}),e(d,{prop:"url",label:"资源路径",align:"center"}),e(d,{prop:"description",label:"描述",align:"center"}),e(d,{prop:"createdTime",label:"添加时间",formatter:t(X),align:"center"},null,8,["formatter"]),e(d,{label:"操作",align:"center"},{default:o(({row:r})=>[e(a,{type:"primary",onClick:c=>{var n;return(n=t(E))==null?void 0:n.initAndShow(r.id)}},{default:o(()=>[_("编辑")]),_:2},1032,["onClick"]),e(a,{type:"danger",onClick:c=>s(r.id)},{default:o(()=>[_("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(T,{onSizeChange:l[7]||(l[7]=r=>{t(v)({size:r,current:1})}),onCurrentChange:l[8]||(l[8]=r=>{t(v)({current:r})}),"current-page":t(k).current,"page-sizes":[5,10,20,30],"page-size":t(k).size,layout:"total, sizes, prev, pager, next, jumper",total:t(k).total},null,8,["current-page","page-size","total"]),e(se,{ref_key:"dlgCreateOrEdit",ref:E},null,512)]),_:1})}}});const qe=te(ue,[["__scopeId","data-v-05c4cf03"]]);export{qe as default};
