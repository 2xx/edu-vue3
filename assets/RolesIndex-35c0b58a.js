import{E as y}from"./index-454643d3.js";import{E as j}from"./el-card-80e98f78.js";import{E as A}from"./el-pagination-912f9994.js";import{E as I}from"./el-input-c28d0f82.js";/* empty css               */import"./el-select-a246b828.js";import"./el-popper-4f7320ad.js";import{E as F,a as N}from"./el-table-column-33d9e1db.js";import"./el-checkbox-55230050.js";import"./el-tooltip-4ed993c7.js";import{E as R,a as z}from"./el-form-item-47cac641.js";import{E as B}from"./users-4d3745c7.js";import{g as q,s as P,a as M,d as h}from"./roles-90df6199.js";import{E as K}from"./el-dialog-533508f3.js";import"./el-overlay-9a593780.js";import{d as O,K as E,N as U,o as T,c as D,w as n,Z as L,a as e,ad as p,u as o,O as W}from"./runtime-core.esm-bundler-d5958d54.js";import{t as Z}from"./timeHandlers-ece731f7.js";import{E as G}from"./el-message-box-8bd1bbf3.js";import{_ as H}from"./_plugin-vue_export-helper-c27b6911.js";import"./index-309dffdd.js";import"./isEqual-a9ed7f07.js";import"./_Uint8Array-d1f10f11.js";import"./scroll-3e4250e8.js";import"./index-8a559d97.js";import"./_initCloneObject-c4f14d92.js";import"./flatten-5a56c86a.js";import"./refs-e5ab6f88.js";import"./dayjs.min-ea7bbe63.js";const J={class:"dialog-footer"},Q=O({__name:"DlgRoleCreateOrEdit",emits:["role-change"],setup(w,{expose:c,emit:k}){const s=E(!1),t="100px",i=()=>({code:"",name:"",description:""}),r=U(i()),v=E(!0),f=E("");c({initAndShow:async(d=0)=>{if(s.value=!0,Object.assign(r,i()),d){v.value=!1,f.value="更新";const{data:a}=await q(d);if(a.code==="000000")console.log(a),Object.assign(r,a.data);else throw y.error(`获取ID为${d}的角色信息失败`+a.mesg),new Error(`获取ID为${d}的角色信息失败`+a.mesg)}else v.value=!0,f.value="创建"}});const V=async()=>{const{data:d}=await P(r).finally(()=>s.value=!1);if(d.code==="000000")y.success(`${f.value}角色成功!`),k("role-change");else throw y.error(`${f.value}角色失败...`),new Error(`${f.value}角色失败...`)};return(d,a)=>{const l=I,m=R,C=z,$=B,S=K;return T(),D(S,{modelValue:o(s),"onUpdate:modelValue":a[4]||(a[4]=_=>W(s)?s.value=_:null),title:o(f)+"角色"},{footer:n(()=>[L("span",J,[e($,{onClick:a[3]||(a[3]=_=>s.value=!1)},{default:n(()=>[p("取消")]),_:1}),e($,{type:"primary",onClick:V},{default:n(()=>[p(" 确认 ")]),_:1})])]),default:n(()=>[e(C,{model:o(r)},{default:n(()=>[e(m,{label:"角色名称","label-width":t,prop:"name"},{default:n(()=>[e(l,{modelValue:o(r).name,"onUpdate:modelValue":a[0]||(a[0]=_=>o(r).name=_),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"角色编码","label-width":t,prop:"code"},{default:n(()=>[e(l,{modelValue:o(r).code,"onUpdate:modelValue":a[1]||(a[1]=_=>o(r).code=_),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(m,{label:"描述","label-width":t,prop:"code"},{default:n(()=>[e(l,{modelValue:o(r).description,"onUpdate:modelValue":a[2]||(a[2]=_=>o(r).description=_),autocomplete:"off",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),u=U({name:"",size:5}),x=E({records:[],size:0,total:0}),g=async(w={})=>{Object.assign(u,w);const{data:c}=await M(u);if(c.code==="000000")x.value=c.data;else throw y.error("按条件查询角色信息失败..."),new Error("按条件查询角色信息失败...")},X=O({__name:"RolesIndex",setup(w){g();const c=E(null),k=async s=>{await G.confirm("确认要删除吗?","删除询问",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).catch(()=>(y.success("删除角色动作被取消.."),new Promise(()=>{})));const{data:t}=await h(s);if(t.code==="000000")y.success("删除角色成功!"),g({current:1});else throw y.error("删除角色失败.."+t.mesg),new Error("删除角色失败.."+t.mesg)};return(s,t)=>{const i=B,r=I,v=R,f=z,b=F,V=N,d=A,a=j;return T(),D(a,{class:"box-card"},{header:n(()=>[e(i,{onClick:t[0]||(t[0]=l=>{var m;return(m=o(c))==null?void 0:m.initAndShow()})},{default:n(()=>[p("新建角色")]),_:1}),e(f,{inline:!0,model:o(u),class:"demo-form-inline"},{default:n(()=>[e(v,{label:"输入搜索"},{default:n(()=>[e(r,{modelValue:o(u).name,"onUpdate:modelValue":t[1]||(t[1]=l=>o(u).name=l),placeholder:"角色名称"},null,8,["modelValue"])]),_:1}),e(v,null,{default:n(()=>[e(i,{type:"",onClick:t[2]||(t[2]=l=>o(g)({name:""}))},{default:n(()=>[p("重置")]),_:1}),e(i,{type:"primary",onClick:t[3]||(t[3]=l=>o(g)({current:1}))},{default:n(()=>[p("查询")]),_:1})]),_:1})]),_:1},8,["model"])]),default:n(()=>[e(V,{data:o(x).records,border:"",style:{width:"100%"}},{default:n(()=>[e(b,{type:"index",label:"序号",align:"center"}),e(b,{prop:"name",label:"角色名称",align:"center"}),e(b,{prop:"description",label:"描述",align:"center"}),e(b,{prop:"createdTime",label:"添加时间",formatter:o(Z),align:"center"},null,8,["formatter"]),e(b,{label:"操作",align:"center",width:"150"},{default:n(({row:l})=>[e(i,{type:"primary",link:"",onClick:m=>s.$router.push({name:"alloc-menus",params:{roleId:l.id}})},{default:n(()=>[p("分配菜单")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>s.$router.push({name:"alloc-resources",params:{roleId:l.id}})},{default:n(()=>[p("分配资源")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>{var C;return(C=o(c))==null?void 0:C.initAndShow(l.id)}},{default:n(()=>[p("编辑")]),_:2},1032,["onClick"]),e(i,{type:"primary",link:"",onClick:m=>k(l.id)},{default:n(()=>[p("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(d,{"current-page":o(u).current,"onUpdate:current-page":t[4]||(t[4]=l=>o(u).current=l),"page-size":o(u).size,"onUpdate:page-size":t[5]||(t[5]=l=>o(u).size=l),"page-sizes":[5,10,20,30],layout:"total, sizes, prev, pager, next, jumper",total:o(x).total,onSizeChange:t[6]||(t[6]=l=>{o(g)({size:l,current:1})}),onCurrentChange:t[7]||(t[7]=l=>{o(g)({current:l})})},null,8,["current-page","page-size","total"]),e(Q,{ref_key:"dlgCreateOrEdit",ref:c,onRoleChange:t[8]||(t[8]=l=>o(g)({current:1}))},null,512)]),_:1})}}});const Ie=H(X,[["__scopeId","data-v-316b0c8d"]]);export{Ie as default};
